public string HTML(DataGridView data,string Name){var sb=new StringBuilder("<html><head><meta charset='utf-8'><title>").Append(Name).Append("</title>").Append("</head><body><table cellspacing='0'border='1'><tr>");int columns=data.ColumnCount,rows=data.RowCount;if(data.AllowUserToAddRows)rows--;for(int i=0;i<columns;i++)sb.Append("<th>").Append(data.Columns[i].HeaderText).Append("</th>");sb.Append("</tr>");for(int i=0;i<rows;i++) {sb.Append("<tr>");for(int j=0;j<columns;j++)sb.Append("<td>").Append(data[j,i].Value).Append("</td>");sb.Append("</tr>"); }return sb.Append("</table></body></html>").ToString(); }